# -*- coding: utf-8 -*-
"""Untitled3.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Re6P6V7ikV__ldeLdPwRgApYb6mWlPkE
"""

import gzip
import shutil
import matplotlib.pyplot as plt
import numpy as np
import gzip
import shutil
import xarray as xr
# conda install -c conda-forge cfgrib
# conda install -c conda-forge pygrib=2.0.1

#pip install pygrib

#import pygrib
#pip install pyproj
# conda install -c conda-forge pygrib=2.0.1
#gr = pygrib.open('/content/file.grib2')
 

#https://stackoverflow.com/questions/68938395/python-decoding-ndfd-grib-binary-file-similar-to-writing-then-reading-the-file-u
file_content =''
with gzip.open('./lumo-app/RadarOnly_QPE_24H_00.00_20210101-000000.grib2.gz', 'rb') as f_in:
  with open('./file.grib2', 'wb') as f_out:
    shutil.copyfileobj(f_in, f_out)

#https://xarray.pydata.org/en/stable/examples/ERA5-GRIB-example.html
#ds = xr.open_dataset("./lumo-app/RadarOnly_QPE_24H_00.00_20210101-000000.grib2/MRMS_RadarOnly_QPE_24H_00.00_20210101-000000.grib2", engine='cfgrib').load()
#print(ds)
ds = xr.open_dataset("./test/MRMS_RadarOnly_QPE_24H_00.00_20220107-230000.grib2", engine='cfgrib').load()
print(ds)

print('2')
ds2 = xr.open_dataset("./file.grib2", engine='cfgrib').load()
print(ds2)
#ds.plot(cmap=plt.cm.coolwarm)
#xarray.plot.imshow(ds)
#ds.unkown.plot(cmap=plt.cm.coolwarm)

#ds.t2m[0].plot(cmap=plt.cm.coolwarm)
#with gzip.open('/content/RadarOnly_QPE_24H_00.00_20210101-000000.grib2.gz', 'rb') as f_in:
#    with open('/content/file.grib2', 'wb') as f_out:
#        shutil.copyfileobj(f_in, f_out)

#with gzip.open('/content/RadarOnly_QPE_24H_00.00_20210101-000000.grib2.gz', 'rb') as f_in:
    #with open('/content/file.grib2', 'wb') as f_out:
    #    shutil.copyfileobj(f_in, f_out)
#    file_content = f_in.read()
#file_content

